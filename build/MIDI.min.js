if("undefined"==typeof MIDI&&(MIDI={}),function(e){"use strict";function n(e){r++;var n=document.body,o=new Audio,a=e.split(";")[0];o.id="audio",o.setAttribute("preload","auto"),o.setAttribute("audiobuffer",!0),o.addEventListener("error",function(){n.removeChild(o),t[a]=!1,r--},!1),o.addEventListener("canplaythrough",function(){n.removeChild(o),t[a]=!0,r--},!1),o.src="data:"+e,n.appendChild(o)}var t={},r=0;e.audioDetect=function(e){if(navigator.requestMIDIAccess){var o=Function.prototype.toString,a=-1!==o.call(navigator.requestMIDIAccess).indexOf("[native code]");if(a)t.webmidi=!0;else for(var i=0;navigator.plugins.length>i;i++){var u=navigator.plugins[i];u.name.indexOf("Jazz-Plugin")>=0&&(t.webmidi=!0)}}if("undefined"==typeof Audio)return e(t),void 0;t.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(t.webaudio=!0);var s=new Audio;if(!s.canPlayType)return e(t),void 0;var c=s.canPlayType('audio/ogg; codecs="vorbis"');c="probably"===c||"maybe"===c;var l=s.canPlayType("audio/mpeg");if(l="probably"===l||"maybe"===l,!c&&!l)return e(t),void 0;c&&n("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),l&&n("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var d=Date.now(),f=setInterval(function(){var n=Date.now()-d>5e3;(!r||n)&&(clearInterval(f),e(t))},1)}}(MIDI),function(e){"use strict";function n(e){return e.replace(/[^a-z0-9_ ]/gi,"").replace(/[ ]/g,"_").toLowerCase()}function t(e,n){var t=a[n];return t?t[e]:void 0}function r(n,t,r,o){var u=a[t];if(u){o?setTimeout(function(){u[n]=r},o):u[n]=r;var s=e.messageHandler[n]||i[n];s&&s(t,r,o)}}var o=function(e){var t={},r=t.byCategory={},o=t.byId={},a=t.byName={};for(var i in e)for(var u=e[i],s=0,c=u.length;c>s;s++){var l=u[s];if(l){var d=parseInt(l.substr(0,l.indexOf(" ")),10),f=l.replace(d+" ",""),p=n(f),A=n(i),m={id:p,name:f,program:--d,category:i};o[d]=m,a[p]=m,r[A]=r[A]||[],r[A].push(m)}}return t}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]});o.getProgramSpec=function(t){var r;return(r="string"==typeof t?o.byName[n(t)]:o.byId[t])?r:(e.handleError("invalid program",arguments),void 0)},e.getProgram=function(e){return t("program",e)},e.programChange=function(e,n,t){var a=o.getProgramSpec(n);a&&isFinite(n=a.program)&&r("program",e,n,t)},e.getMono=function(e){return t("mono",e)},e.setMono=function(e,n,t){isFinite(n)&&r("mono",e,n,t)},e.getOmni=function(e){return t("omni",e)},e.setOmni=function(e,n,t){isFinite(n)&&r("omni",e,n,t)},e.getSolo=function(e){return t("solo",e)},e.setSolo=function(e,n,t){isFinite(n)&&r("solo",e,n,t)};var a=function(){for(var e={},n=0;15>=n;n++)e[n]={number:n,program:n,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}();e.keyToNote={},e.noteToKey={},function(){for(var n=21,t=108,r=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],o=n;t>=o;o++){var a=(o-12)/12>>0,i=r[o%12]+a;e.keyToNote[i]=o,e.noteToKey[o]=i}}(),e.channels=a,e.GM=o,e.messageHandler={};var i={program:function(n,t){e.__api&&(e.player.isPlaying?(e.player.pause(),e.loadProgram(t,e.player.play)):e.loadProgram(t))}};e.handleError=function(e,n){console&&console.error&&console.error(e,n)}}(MIDI),"undefined"==typeof MIDI&&(MIDI={}),MIDI.Soundfont=MIDI.Soundfont||{},MIDI.player=MIDI.player||{},function(e){"use strict";function n(n,r){function o(){u&&u("load",1),e[r].connect(n)}var a=n.format,i=n.instruments,u=n.onprogress,s=n.onerror,c=i.length,l=c;if(c)for(var d=0;c>d;d++){var f=i[d];e.Soundfont[f]?!--l&&o():t(i[d],a,function(e,n){var t=n/c,r=(c-l)/c;u&&u("load",t+r,f)},function(){!--l&&o()},s)}else o()}function t(n,t,r,o,a){var i=e.soundfontUrl+n+"-"+t+".js";e.USE_XHR?galactic.util.request({url:i,format:"text",onerror:a,onprogress:r,onsuccess:function(e,n){var t=document.createElement("script");t.language="javascript",t.type="text/javascript",t.text=n,document.body.appendChild(t),o()}}):dom.loadScript.add({url:i,verify:'MIDI.Soundfont["'+n+'"]',onerror:a,onsuccess:function(){o()}})}"undefined"!=typeof console&&console.log&&console.log("%c♥ MIDI.js 0.4.2 ♥","color: red;"),e.DEBUG=!0,e.USE_XHR=!0,e.soundfontUrl="./soundfont/",e.loadPlugin=function(n){function t(t){var o=location.hash,a="";if(t[n.api]?a=n.api:t[o.substr(1)]?a=o.substr(1):t.webmidi?a="webmidi":window.AudioContext?a="webaudio":window.Audio&&(a="audiotag"),r[a]){if(n.audioFormat)var i=n.audioFormat;else var i=t["audio/ogg"]?"ogg":"mp3";e.__api=a,e.__audioFormat=i,e.supports=t,e.loadProgram(n)}}"function"==typeof n&&(n={onsuccess:n}),n=n||{},n.api=n.api||e.__api,n.soundfontUrl&&(e.soundfontUrl=n.soundfontUrl),e.supports?t(e.supports):e.audioDetect(t)},e.loadProgram=function(){function n(n){var t=n.instruments||n.instrument||e.channels[0].program;"object"!=typeof t&&(t=void 0===t?[]:[t]);for(var r=0;t.length>r;r++){var o=t[r];o===+o&&e.GM.byId[o]&&(t[r]=e.GM.byId[o].id)}return t}return function(t,o,a,i){t=t||{},"object"!=typeof t&&(t={instrument:t}),a&&(t.onerror=a),i&&(t.onprogress=i),o&&(t.onsuccess=o),t.format=e.__audioFormat,t.instruments=n(t),r[e.__api](t)}}();var r={webmidi:function(n){e.WebMIDI.connect(n)},audiotag:function(e){n(e,"AudioTag")},webaudio:function(e){n(e,"WebAudio")}};e.setDefaultPlugin=function(n){for(var t in n)e[t]=n[t]}}(MIDI),"undefined"==typeof MIDI&&(MIDI={}),MIDI.player===void 0&&(MIDI.player={}),function(){"use strict";function e(e,t,r,o){return setTimeout(function(){d&&d(e),s.currentTime=r,c.shift();var t=e.channel+"x"+e.noteNumber,o=e.subtype;"noteOn"===o?l[t]=e:"noteOff"===o&&delete l[t],s.duration>A&&(1e3>c.length?n(A,!0):s.currentTime===A&&n(A,!0))},r-o)}function n(n,l,d){l||(s.isPlaying&&r(),s.isPlaying=!0,s.packets=s.replayer.getData(),s.duration=i());var v=0,q=s.packets,h=q.length;c[0]&&c[0].interval||0;var y,S=n-s.currentTime,I=a();if("webaudio"!==MIDI.api&&(y=u(),m=m||y,I.currentTime=(y-m)/1e3),f=I.currentTime,l)var b=p,T=A;else var M=t(n),b=M.idx,T=A=M.offset;for(;h>b&&100>=v;){var w=q[b];p=++b,A+=w[1],n=A-T;var B=w[0].event;if("channel"===B.type){var D=B.subtype;if(!g[D])continue;var U=B.channel,x=MIDI.channels[U],E=I.currentTime+(n+S)/1e3,F=Math.max(0,E+s.timeDelay),K=A-T;switch(D){case"controller":MIDI.setController(U,B.controllerType,B.value,F);break;case"programChange":MIDI.programChange(U,B.programNumber,F);break;case"pitchBend":MIDI.pitchBend(U,B.value,F);break;case"noteOn":if(!x.mute){var C=o(0,127,B.noteNumber+s.transpose);c.push({event:B,time:K,source:MIDI.noteOn(U,C,B.velocity,F),interval:e(B,C,A,T-S)}),v++}break;case"noteOff":if(!x.mute){var C=o(0,127,B.noteNumber+s.transpose);c.push({event:B,time:K,source:MIDI.noteOff(U,C,F),interval:e(B,C,A,T-S)}),v++}break;default:}}}d&&d(c)}function t(e){for(var n=s.packets,t=n.length,r=0,o=0;t>r;r++){var a=n[r],i=a[1];if(!(e>o+i))break;o+=i}return{idx:r,offset:o}}function r(){if(s.isPlaying){s.isPlaying=!1;var e=a();for(s.currentTime+=1e3*(e.currentTime-f);c.length;){var n=c.pop();n&&(n.source&&("number"==typeof n.source?clearTimeout(n.source):n.source.disconnect(0)),clearTimeout(n.interval))}for(var t in l){var r=l[t];d({channel:r.channel,noteNumber:r.noteNumber,status:r.status-16,subtype:"noteOff",type:"channel"})}}}function o(e,n,t){return e>t?e:t>n?n:t}function a(){return"webaudio"===MIDI.api?MIDI.WebAudio.getContext():(s.ctx={currentTime:0},s.ctx)}function i(){for(var e=s.packets,n=e.length,t=0,r=0;n>r;r++)t+=e[r][1];return t}function u(){return window.performance&&performance.now?performance.now():Date.now()}var s=MIDI.player;s.currentTime=0,s.duration=0,s.isPlaying=!1,s.BPM=null,s.timeDelay=0,s.timeWarp=1,s.transpose=0,s.play=s.start=function(e){s.currentTime=o(0,s.duration,s.currentTime),n(s.currentTime,null,e)},s.stop=function(){r(),s.currentTime=0},s.pause=function(){r()},s.toggle=function(){s.isPlaying?s.pause():s.play()},s.on=s.addListener=function(e){d=e},s.off=s.removeListener=function(){d=void 0},s.clearAnimation=function(){s.frameId&&cancelAnimationFrame(s.frameId)},s.setAnimation=function(e){var n=0,t=0,r=0;s.clearAnimation(),requestAnimationFrame(function o(){if(s.frameId=requestAnimationFrame(o),s.duration){s.isPlaying?(n=r===s.currentTime?t-Date.now():0,n=0===s.currentTime?0:s.currentTime-n,r!==s.currentTime&&(t=Date.now(),r=s.currentTime)):n=s.currentTime;var a=s.duration,i=n/1e3,u=i/60,c=i-60*u,l=60*u+c,d=a/1e3;if(-1>d-l)return;var f=Math.min(1,l/d);f!==e.progress&&(e.progress=f,e({progress:f,currentTime:l,duration:d}))}})},s.loadFile=function(){function e(){for(var e=MIDI.GM,n={},t={},r=s.packets,o=0;r.length>o;o++){var a=r[o][0].event;if("channel"===a.type){var i=a.channel;switch(a.subtype){case"programChange":t[i]=a.programNumber;break;case"noteOn":var u=t[i];if(u===+u){if(g.programChange)var c=e.byId[u];else var i=MIDI.channels[i],c=e.byId[i.program];n[c.id]=!0}}}}var l=[];for(var d in n)l.push(d);return l}function n(n,t,r){try{s.replayer=new Replayer(MidiFile(s.currentData),1/s.timeWarp,null,s.BPM),s.packets=s.replayer.getData(),s.duration=i(),MIDI.loadPlugin({instruments:e(),onsuccess:n,onprogress:t,onerror:r})}catch(o){r&&r(o)}}function t(e){for(var n=[],t=String.fromCharCode,r=0,o=e.length;o>r;r++)n[r]=t(255&e.charCodeAt(r));return n.join("")}return function(e,r,o,a){"string"==typeof e&&(e={src:e});var i=e.src,r=r||e.onsuccess,a=a||e.onerror,o=o||e.onprogress;if(s.stop(),-1!==i.indexOf("base64,"))s.currentData=atob(i.split(",")[1]),n(r,o,a);else{var u=new XMLHttpRequest;u.open("GET",i),u.overrideMimeType("text/plain; charset=x-user-defined"),u.onreadystatechange=function(){4===this.readyState&&(200===this.status&&this.responseText?(s.currentData=t(this.responseText),n(r,o,a)):a&&a("Unable to load MIDI file."))},u.send()}}}();var c=[],l={},d=void 0,f=0;s.packets={};var p,A,m,g={controller:!0,noteOff:!0,noteOn:!0,pitchBend:!0,programChange:!0};s.handleEvent=function(e,n){g[e]=n}}(),function(e){"use strict";window.Audio&&function(){function n(n,t){if(e.channels[n]){var r=e.channels[n].program,o=e.GM.byId[r].id,t=c[t];if(t){var l=o+""+t.id,d=(i+1)%u.length,f=u[d];if(s[d]=l,!e.Soundfont[o])return e.DEBUG&&console.log("404",o),void 0;f.src=e.Soundfont[o][t.id],f.volume=a/127,f.play(),i=d}}}function t(n,t){if(e.channels[n]){var r=e.channels[n].program,o=e.GM.byId[r].id,t=c[t];if(t)for(var a=o+""+t.id,l=0,d=u.length;d>l;l++){var f=(l+i+1)%d,p=s[f];if(p&&p==a)return u[f].pause(),s[f]=null,void 0}}}for(var r=e.AudioTag={api:"audiotag"},o={},a=127,i=-1,u=[],s=[],c={},l=0;12>l;l++)u[l]=new Audio;r.audioBuffers=u,r.messageHandler={},r.send=function(){},r.setController=function(){},r.setVolume=function(e,n){a=n},r.pitchBend=function(){},r.noteOn=function(e,t,r,a){var i=o[t];if(c[i]){if(a)return setTimeout(function(){n(e,i)},1e3*a);n(e,i)}},r.noteOff=function(){},r.chordOn=function(e,t,r,a){for(var i=0;t.length>i;i++){var u=t[i],s=o[u];if(c[s]){if(a)return setTimeout(function(){n(e,s)},1e3*a);n(e,s)}}},r.chordOff=function(e,n,r){for(var a=0;n.length>a;a++){var i=n[a],u=o[i];if(c[u]){if(r)return setTimeout(function(){t(e,u)},1e3*r);t(e,u)}}},r.stopAllNotes=function(){for(var e=0,n=u.length;n>e;e++)u[e].pause()},r.connect=function(n){e.setDefaultPlugin(r);for(var t in e.keyToNote)o[e.keyToNote[t]]=t,c[t]={id:t};n.onsuccess&&n.onsuccess()}}()}(MIDI),function(e){"use strict";window.AudioContext&&function(){function n(e,n,t){if(o){var a=new Audio;a.src=e,a.controls=!1,a.autoplay=!1,a.preload=!1,a.addEventListener("canplay",function(){n&&n(a)}),a.addEventListener("error",function(e){t&&t(e)}),document.body.appendChild(a)}else if(0===e.indexOf("data:audio")){var i=e.split(",")[1],u=Base64Binary.decodeArrayBuffer(i);r.decodeAudioData(u,n,t)}else{var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=function(){r.decodeAudioData(s.response,n,t)},s.send()}}function t(){return new(window.AudioContext||window.webkitAudioContext)}var r,o=!1,a=e.WebAudio={api:"webaudio"},i={},u={},s=127,c={};a.audioBuffers=c,a.messageHandler={},a.send=function(){},a.setController=function(){},a.setVolume=function(e,n,t){t?setTimeout(function(){s=n},1e3*t):s=n},a.pitchBend=function(n,t,r){var o=e.channels[n];o&&(r?setTimeout(function(){o.pitchBend=t},r):o.pitchBend=t)},a.noteOn=function(n,t,a,l){l=l||0;var d=e.channels[n],f=d.program,p=f+"x"+t,A=c[p];if(A){if(r.currentTime>l&&(l+=r.currentTime),o)var m=r.createMediaElementSource(A);else{var m=r.createBufferSource();m.buffer=A}if(u){var g=m;for(var v in u)g.connect(u[v].input),g=u[v]}var q=2*a/127*(s/127)-1;if(m.connect(r.destination),m.playbackRate.value=1,m.gainNode=r.createGain(),m.gainNode.connect(r.destination),m.gainNode.gain.value=Math.min(1,Math.max(-1,q)),m.connect(m.gainNode),o){if(l)return setTimeout(function(){A.currentTime=0,A.play()},1e3*l);A.currentTime=0,A.play()}else m.start(l||0);return i[n+"x"+t]=m,m}e.handleError("no buffer",arguments)},a.noteOff=function(n,t,a){a=a||0;var u=e.channels[n],s=u.program,l=s+"x"+t,d=c[l];if(d){r.currentTime>a&&(a+=r.currentTime);var f=i[n+"x"+t];if(f){if(f.gainNode){var p=f.gainNode.gain;p.linearRampToValueAtTime(p.value,a),p.linearRampToValueAtTime(-1,a+.3)}return o?a?setTimeout(function(){d.pause()},1e3*a):d.pause():f.noteOff?f.noteOff(a+.5):f.stop(a+.5),delete i[n+"x"+t],f}}},a.chordOn=function(e,n,t,r){for(var o,i={},u=0,s=n.length;s>u;u++)i[o=n[u]]=a.noteOn(e,o,t,r);return i},a.chordOff=function(e,n,t){for(var r,o={},i=0,u=n.length;u>i;i++)o[r=n[i]]=a.noteOff(e,r,t);return o},a.stopAllNotes=function(){for(var e in i){var n=0;r.currentTime>n&&(n+=r.currentTime);var t=i[e];t.gain.linearRampToValueAtTime(1,n),t.gain.linearRampToValueAtTime(0,n+.3),t.noteOff?t.noteOff(n+.3):t.stop(n+.3),delete i[e]}},a.setEffects=function(n){if(!r.tunajs)return e.handleError("effects not installed.",arguments),void 0;for(var t=0;n.length>t;t++){var o=n[t],a=new r.tunajs[o.type](o);a.connect(r.destination),u[o.type]=a}},a.connect=function(n){e.setDefaultPlugin(a),a.setContext(r||t(),n.onsuccess)},a.getContext=function(){return r},a.setContext=function(t,o){function a(){for(var e in d)if(d[e])return;o&&(o(),o=null)}function i(t,r,o,i){var u=t[i];u&&(d[r]++,n(u,function(n){n.id=i;var o=e.keyToNote[i];c[r+"x"+o]=n,0===--d[r]&&(t.isLoaded=!0,e.DEBUG&&console.log("loaded: ",p),a(p))},function(){e.handleError("audio could not load",arguments)}))}r=t,"undefined"!=typeof Tuna&&(r.tunajs instanceof Tuna||(r.tunajs=new Tuna(r)));var u=[],s=e.keyToNote;for(var l in s)u.push(l);var d={},f=e.Soundfont;for(var p in f){var A=f[p];if(!A.isLoaded){var m=e.GM.byName[p];if(m){var g=m.program;d[g]=0;for(var v=0;u.length>v;v++){var l=u[v];i(A,g,v,l)}}}}setTimeout(a,1)}}()}(MIDI),function(e){"use strict";var n=null,t=e.WebMIDI={api:"webmidi"};t.messageHandler={},t.messageHandler.program=function(e,t,r){n.send([192+e,t],1e3*r)},t.send=function(e,t){n.send(e,1e3*t)},t.setController=function(e,t,r,o){n.send([e,t,r],1e3*o)},t.setVolume=function(e,t,r){n.send([176+e,7,t],1e3*r)},t.pitchBend=function(e,t,r){n.send([224+e,t],1e3*r)},t.noteOn=function(e,t,r,o){n.send([144+e,t,r],1e3*o)},t.noteOff=function(e,t,r){n.send([128+e,t,0],1e3*r)},t.chordOn=function(e,t,r,o){for(var a=0;t.length>a;a++){var i=t[a];n.send([144+e,i,r],1e3*o)}},t.chordOff=function(e,t,r){for(var o=0;t.length>o;o++){var a=t[o];n.send([128+e,a,0],1e3*r)}},t.stopAllNotes=function(){n.cancel();for(var e=0;16>e;e++)n.send([176+e,123,0])},t.connect=function(r){function o(n){if(i&&i(n),window.AudioContext)r.api="webaudio";else{if(!window.Audio)return;r.api="audiotag"}e.loadPlugin(r)}var a=r.onsuccess,i=r.onerror;e.setDefaultPlugin(t),navigator.requestMIDIAccess().then(function(e){var t=e.outputs;n="function"==typeof t?t()[0]:t[0],void 0===n?o():a&&a()},i)}}(MIDI),"undefined"==typeof galactic&&(galactic={}),function(e){var n=e.util||(e.util={});if(n.request=function(n,r,o,a){"use strict";"string"==typeof n&&(n={url:n});var i=n.data,u=n.url,s=n.method||(n.data?"POST":"GET"),c=n.format,l=n.headers,d=n.responseType,f=n.withCredentials||!1,a=a||n.onprogress,r=r||n.onsuccess,o=o||n.onerror;if(t!==void 0&&e.loc.isLocalUrl(u))return t.readFile(u,"utf8",function(e,n){e?o&&o(e):r&&r({responseText:n})}),void 0;var p=new XMLHttpRequest;if(p.open(s,u,!0),l)for(var A in l)p.setRequestHeader(A,l[A]);else i&&p.setRequestHeader("Content-type","application/x-www-form-urlencoded");return d&&(p.responseType=d),f&&(p.withCredentials=!0),o&&"onerror"in p&&(p.onerror=o),a&&p.upload&&"onprogress"in p.upload&&(i?p.upload.onprogress=function(e){a.call(p,e,event.loaded/event.total)}:p.addEventListener("progress",function(e){var n=0;if(e.lengthComputable)n=e.total;else if(p.totalBytes)n=p.totalBytes;else{var t=parseInt(p.getResponseHeader("Content-Length-Raw"));if(!isFinite(t))return;p.totalBytes=n=t}a.call(p,e,e.loaded/n)})),p.onreadystatechange=function(n){if(4===p.readyState)if(200===p.status||304===p.status||308===p.status||0===p.status&&e.client.cordova){if(r){var t;if("json"===c)try{t=JSON.parse(n.target.response)}catch(a){o&&o.call(p,n)}else t="xml"===c?n.target.responseXML:"text"===c?n.target.responseText:n.target.response;r.call(p,n,t)}}else o&&o.call(p,n)},p.send(i),p},"undefined"!=typeof module&&module.exports){var t=require("fs");XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest,module.exports=e.util.request}}(galactic),dom===void 0)var dom={};(function(){"use strict";function e(e,n){try{e=e.split('"').join("").split("'").join("").split("]").join("").split("[").join(".");for(var t=e.split("."),r=t.length,o=n||window,a=0;r>a;a++){var i=t[a];if(null==o[i])return!1;o=o[i]}return!0}catch(u){return!1}}dom.loadScript=function(){return this.loaded={},this.loading={},this},dom.loadScript.prototype.add=function(n){var t=this;"string"==typeof n&&(n={url:n});var r=n.urls;r===void 0&&(r=[{url:n.url,verify:n.verify}]);var o=document.getElementsByTagName("head")[0],a=function(n,r){t.loaded[n.url]||r&&e(r)===!1||(t.loaded[n.url]=!0,t.loading[n.url]&&t.loading[n.url](),delete t.loading[n.url],n.onsuccess&&n.onsuccess(),f!==void 0&&f())},i=!1,u=[],s=function(e){if("string"==typeof e&&(e={url:e,verify:n.verify}),/([\w\d.\[\]\'\"])$/.test(e.verify)){var r=e.test=e.verify;if("object"==typeof r)for(var s=0;r.length>s;s++)u.push(r[s]);else u.push(r)}if(!t.loaded[e.url]){var l=document.createElement("script");l.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&a(e)},l.onload=function(){a(e)},l.onerror=function(){if(i=!0,delete t.loading[e.url],"object"==typeof e.test)for(var n in e.test)c(e.test[n]);else c(e.test)},l.setAttribute("type","text/javascript"),l.setAttribute("src",e.url),o.appendChild(l),t.loading[e.url]=function(){}}},c=function(e){for(var n=[],t=0;u.length>t;t++)u[t]!==e&&n.push(u[t]);u=n},l=function(t){if(t)a(t,t.test);else for(var o=0;r.length>o;o++)a(r[o],r[o].test);for(var s=!0,o=0;u.length>o;o++)e(u[o])===!1&&(s=!1);!n.strictOrder&&s?i?n.error&&n.error():n.onsuccess&&n.onsuccess():setTimeout(function(){l(t)},10)};if(n.strictOrder){var d=-1,f=function(){if(d++,r[d]){var e=r[d],o=e.url;t.loading[o]?t.loading[o]=function(){e.onsuccess&&e.onsuccess(),f()}:t.loaded[o]?f():(s(e),l(e))}else i?n.error&&n.error():n.onsuccess&&n.onsuccess()};f()}else for(var d=0;r.length>d;d++)s(r[d]),l(r[d])},dom.loadScript=new dom.loadScript})(),"undefined"!=typeof module&&module.exports&&(module.exports=dom.loadScript);